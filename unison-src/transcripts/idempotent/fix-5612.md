``` ucm
scratch/main> builtins.mergeio lib.builtin

  Done.
```

``` unison
conflicted : Nat
conflicted = 100

xxx : Text
xxx = "xxx"

yyy : Text
yyy = xxx ++ "yyy"

zzz : Text
zzz = yyy ++ "zzz"
```

``` ucm :added-by-ucm
  Loading changes detected in scratch.u.

  I found and typechecked these definitions in scratch.u. If you
  do an `add` or `update`, here's how your codebase would
  change:

    ⍟ These new definitions are ok to `add`:
    
      conflicted : Nat
      xxx        : Text
      yyy        : Text
      zzz        : Text
```

``` ucm
scratch/main> add

  ⍟ I've added these definitions:

    conflicted : Nat
    xxx        : Text
    yyy        : Text
    zzz        : Text

scratch/main> branch topic

  Done. I've created the topic branch based off of main.

  Tip: To merge your work back into the main branch, first
       `switch /main` then `merge /topic`.
```

``` unison
conflicted : Nat
conflicted = 200
```

``` ucm :added-by-ucm
  Loading changes detected in scratch.u.

  I found and typechecked these definitions in scratch.u. If you
  do an `add` or `update`, here's how your codebase would
  change:

    ⍟ These names already exist. You can `update` them to your
      new definition:
    
      conflicted : Nat
```

``` ucm
scratch/topic> update

  Okay, I'm searching the branch for code that needs to be
  updated...

  Done.

scratch/main> switch /main
```

``` unison
conflicted : Nat
conflicted = 300

xxx : Text
xxx = "xxx2"

zzz : Text
zzz = yyy ++ "zzz2"
```

``` ucm :added-by-ucm
  Loading changes detected in scratch.u.

  I found and typechecked these definitions in scratch.u. If you
  do an `add` or `update`, here's how your codebase would
  change:

    ⍟ These names already exist. You can `update` them to your
      new definition:
    
      conflicted : Nat
      xxx        : Text
      zzz        : Text
```

``` ucm
scratch/main> update

  Okay, I'm searching the branch for code that needs to be
  updated...

  That's done. Now I'm making sure everything typechecks...

  Everything typechecks, so I'm saving the results...

  Done.
```

`merge` used to put `zzz` in the namespace with a nameless dependency on the old `yyy`. Now, it properly puts it in the
scratch file.

``` ucm :error
scratch/main> merge /topic

  Loading branches...

  Loading definitions...

  Computing diffs...

  Loading dependents of changes...

  Loading and merging library dependencies...

  Rendering Unison file...

  I couldn't automatically merge scratch/topic into
  scratch/main. However, I've added the definitions that need
  attention to the top of scratch.u.

  When you're done, you can run

    merge.commit

  to merge your changes back into main and delete the temporary
  branch. Or, if you decide to cancel the merge instead, you can
  run

    delete.branch /merge-topic-into-main

  to delete the temporary branch and switch back to main.
```

``` unison :added-by-ucm scratch.u
-- scratch/main
conflicted : Nat
conflicted = 300

-- scratch/topic
conflicted : Nat
conflicted = 200

-- The definitions below are not conflicted, but they each depend on one or more
-- conflicted definitions above.

yyy : Text
yyy =
  use Text ++
  xxx ++ "yyy"

zzz : Text
zzz =
  use Text ++
  yyy ++ "zzz2"

```
