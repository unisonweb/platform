<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679184677"><span id="local-6989586621679184678"></span></span><span class="hs-comment">-- | See &quot;Test.Inspection&quot;.</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Inspection.Plugin</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#plugin"><span class="hs-identifier">plugin</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier">checkProperty</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#CheckResult"><span class="hs-identifier">CheckResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#prettyProperty"><span class="hs-identifier">prettyProperty</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TH</span></span><span class="hs-cpp">

#if MIN_VERSION_ghc(9,4,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.Error</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Driver.Session</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,0,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Plugins</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SrcLoc</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Utils.Outputable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Outputable</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GhcPlugins</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SrcLoc</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Outputable</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,2,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.TyThing</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Inspection.html"><span class="hs-identifier">Test.Inspection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#Obligation"><span class="hs-identifier">Obligation</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.html#Equivalence"><span class="hs-identifier">Equivalence</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.html#Property"><span class="hs-identifier">Property</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.html#Result"><span class="hs-identifier">Result</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Inspection.Core.html"><span class="hs-identifier">Test.Inspection.Core</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | The plugin. It supports some options:</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- * @-fplugin-opt=Test.Inspection.Plugin:keep-going@ to keep building despite failing obligations</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- * @-fplugin-opt=Test.Inspection.Plugin:keep-going-O0@ to keep building despite failing obligations, when optimisations are off</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- * @-fplugin-opt=Test.Inspection.Plugin:skip-O0@ to skip performing inspections when optimisations are off</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- * @-fplugin-opt=Test.Inspection.Plugin:quiet@ to be silent if all obligations are fulfilled</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- It makes sense to enable only one of @keep-going@, @keep-going-O0@ and</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- @skip-O0@ at a time. @skip-O0@ is useful when working with GHCi, to suppress</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- inspection failure messages and eliminate the overhead of inspection when</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- loading.</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="Test.Inspection.Plugin.html#plugin"><span class="hs-identifier hs-type">plugin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Plugin</span></span><span>
</span><span id="line-58"></span><span id="plugin"><span class="annot"><span class="annottext">plugin :: Plugin
</span><a href="Test.Inspection.Plugin.html#plugin"><span class="hs-identifier hs-var hs-var">plugin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Plugin
</span><span class="hs-identifier hs-var">defaultPlugin</span></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">installCoreToDos</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#install"><span class="hs-identifier hs-type">install</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 806
</span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">pluginRecompile</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679184903"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679184903"><span class="hs-identifier hs-var">_args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PluginRecompile -&gt; IO PluginRecompile
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PluginRecompile
</span><span class="hs-identifier hs-var">NoForceRecompile</span></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">data</span><span> </span><span id="UponFailure"><span class="annot"><a href="Test.Inspection.Plugin.html#UponFailure"><span class="hs-identifier hs-var">UponFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AbortCompilation"><span class="annot"><a href="Test.Inspection.Plugin.html#AbortCompilation"><span class="hs-identifier hs-var">AbortCompilation</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="KeepGoingO0"><span class="annot"><a href="Test.Inspection.Plugin.html#KeepGoingO0"><span class="hs-identifier hs-var">KeepGoingO0</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SkipO0"><span class="annot"><a href="Test.Inspection.Plugin.html#SkipO0"><span class="hs-identifier hs-var">SkipO0</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="KeepGoing"><span class="annot"><a href="Test.Inspection.Plugin.html#KeepGoing"><span class="hs-identifier hs-var">KeepGoing</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679184910"><span id="local-6989586621679184912"><span class="annot"><span class="annottext">UponFailure -&gt; UponFailure -&gt; Bool
(UponFailure -&gt; UponFailure -&gt; Bool)
-&gt; (UponFailure -&gt; UponFailure -&gt; Bool) -&gt; Eq UponFailure
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: UponFailure -&gt; UponFailure -&gt; Bool
== :: UponFailure -&gt; UponFailure -&gt; Bool
$c/= :: UponFailure -&gt; UponFailure -&gt; Bool
/= :: UponFailure -&gt; UponFailure -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="ReportingMode"><span class="annot"><a href="Test.Inspection.Plugin.html#ReportingMode"><span class="hs-identifier hs-var">ReportingMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Verbose"><span class="annot"><a href="Test.Inspection.Plugin.html#Verbose"><span class="hs-identifier hs-var">Verbose</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Quiet"><span class="annot"><a href="Test.Inspection.Plugin.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679184919"><span id="local-6989586621679184921"><span class="annot"><span class="annottext">ReportingMode -&gt; ReportingMode -&gt; Bool
(ReportingMode -&gt; ReportingMode -&gt; Bool)
-&gt; (ReportingMode -&gt; ReportingMode -&gt; Bool) -&gt; Eq ReportingMode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ReportingMode -&gt; ReportingMode -&gt; Bool
== :: ReportingMode -&gt; ReportingMode -&gt; Bool
$c/= :: ReportingMode -&gt; ReportingMode -&gt; Bool
/= :: ReportingMode -&gt; ReportingMode -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">data</span><span> </span><span id="ResultTarget"><span class="annot"><a href="Test.Inspection.Plugin.html#ResultTarget"><span class="hs-identifier hs-var">ResultTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PrintAndAbort"><span class="annot"><a href="Test.Inspection.Plugin.html#PrintAndAbort"><span class="hs-identifier hs-var">PrintAndAbort</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="StoreAt"><span class="annot"><a href="Test.Inspection.Plugin.html#StoreAt"><span class="hs-identifier hs-var">StoreAt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="annot"><a href="Test.Inspection.Plugin.html#install"><span class="hs-identifier hs-type">install</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CommandLineOption</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CoreToDo</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CoreToDo</span></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span id="install"><span class="annot"><span class="annottext">install :: [String] -&gt; [CoreToDo] -&gt; CoreM [CoreToDo]
</span><a href="Test.Inspection.Plugin.html#install"><span class="hs-identifier hs-var hs-var">install</span></a></span></span><span> </span><span id="local-6989586621679184926"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679184926"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679184927"><span class="annot"><span class="annottext">[CoreToDo]
</span><a href="#local-6989586621679184927"><span class="hs-identifier hs-var">passes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CoreToDo] -&gt; CoreM [CoreToDo]
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([CoreToDo] -&gt; CoreM [CoreToDo]) -&gt; [CoreToDo] -&gt; CoreM [CoreToDo]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CoreToDo]
</span><a href="#local-6989586621679184927"><span class="hs-identifier hs-var">passes</span></a></span><span> </span><span class="annot"><span class="annottext">[CoreToDo] -&gt; [CoreToDo] -&gt; [CoreToDo]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CoreToDo
</span><a href="#local-6989586621679184928"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>    </span><span id="local-6989586621679184928"><span class="annot"><span class="annottext">pass :: CoreToDo
</span><a href="#local-6989586621679184928"><span class="hs-identifier hs-var hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; CorePluginPass -&gt; CoreToDo
</span><span class="hs-identifier hs-var">CoreDoPluginPass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Test.Inspection.Plugin&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UponFailure -&gt; ReportingMode -&gt; CorePluginPass
</span><a href="Test.Inspection.Plugin.html#proofPass"><span class="hs-identifier hs-var">proofPass</span></a></span><span> </span><span class="annot"><span class="annottext">UponFailure
</span><a href="#local-6989586621679184931"><span class="hs-identifier hs-var">upon_failure</span></a></span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679184932"><span class="hs-identifier hs-var">report</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679184931"><span class="annot"><span class="annottext">upon_failure :: UponFailure
</span><a href="#local-6989586621679184931"><span class="hs-identifier hs-var hs-var">upon_failure</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;keep-going&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679184926"><span class="hs-identifier hs-var">args</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UponFailure
</span><a href="Test.Inspection.Plugin.html#KeepGoing"><span class="hs-identifier hs-var">KeepGoing</span></a></span><span>
</span><span id="line-76"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;keep-going-O0&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679184926"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UponFailure
</span><a href="Test.Inspection.Plugin.html#KeepGoingO0"><span class="hs-identifier hs-var">KeepGoingO0</span></a></span><span>
</span><span id="line-77"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;skip-O0&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679184926"><span class="hs-identifier hs-var">args</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UponFailure
</span><a href="Test.Inspection.Plugin.html#SkipO0"><span class="hs-identifier hs-var">SkipO0</span></a></span><span>
</span><span id="line-78"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UponFailure
</span><a href="Test.Inspection.Plugin.html#AbortCompilation"><span class="hs-identifier hs-var">AbortCompilation</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679184932"><span class="annot"><span class="annottext">report :: ReportingMode
</span><a href="#local-6989586621679184932"><span class="hs-identifier hs-var hs-var">report</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;quiet&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679184926"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="Test.Inspection.Plugin.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span>
</span><span id="line-80"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="Test.Inspection.Plugin.html#Verbose"><span class="hs-identifier hs-var">Verbose</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Test.Inspection.Plugin.html#extractObligations"><span class="hs-identifier hs-type">extractObligations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#ResultTarget"><span class="hs-identifier hs-type">ResultTarget</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.html#Obligation"><span class="hs-identifier hs-type">Obligation</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="extractObligations"><span class="annot"><span class="annottext">extractObligations :: ModGuts -&gt; (ModGuts, [(ResultTarget, Obligation)])
</span><a href="Test.Inspection.Plugin.html#extractObligations"><span class="hs-identifier hs-var hs-var">extractObligations</span></a></span></span><span> </span><span id="local-6989586621679184945"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679184945"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679184946"><span class="hs-identifier hs-var">guts'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(ResultTarget, Obligation)]
</span><a href="#local-6989586621679184947"><span class="hs-identifier hs-var">obligations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679184948"><span class="annot"><span class="annottext">[Annotation]
</span><a href="#local-6989586621679184948"><span class="hs-identifier hs-var">anns_clean</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679184947"><span class="annot"><span class="annottext">[(ResultTarget, Obligation)]
</span><a href="#local-6989586621679184947"><span class="hs-identifier hs-var">obligations</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Annotation -&gt; Maybe (ResultTarget, Obligation))
-&gt; [Annotation] -&gt; ([Annotation], [(ResultTarget, Obligation)])
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([a], [b])
</span><a href="Test.Inspection.Plugin.html#partitionMaybe"><span class="hs-identifier hs-var">partitionMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Annotation -&gt; Maybe (ResultTarget, Obligation)
</span><a href="Test.Inspection.Plugin.html#findObligationAnn"><span class="hs-identifier hs-var">findObligationAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Annotation]
</span><span class="hs-identifier hs-var">mg_anns</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679184945"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621679184946"><span class="annot"><span class="annottext">guts' :: ModGuts
</span><a href="#local-6989586621679184946"><span class="hs-identifier hs-var hs-var">guts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679184945"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">mg_anns</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679184948"><span class="hs-identifier hs-type">anns_clean</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Test.Inspection.Plugin.html#findObligationAnn"><span class="hs-identifier hs-type">findObligationAnn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Annotation</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#ResultTarget"><span class="hs-identifier hs-type">ResultTarget</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.html#Obligation"><span class="hs-identifier hs-type">Obligation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span id="findObligationAnn"><span class="annot"><span class="annottext">findObligationAnn :: Annotation -&gt; Maybe (ResultTarget, Obligation)
</span><a href="Test.Inspection.Plugin.html#findObligationAnn"><span class="hs-identifier hs-var hs-var">findObligationAnn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Annotation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ModuleTarget</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679184954"><span class="annot"><span class="annottext">AnnPayload
</span><a href="#local-6989586621679184954"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679184955"><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679184955"><span class="hs-identifier hs-var">obl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; Obligation) -&gt; AnnPayload -&gt; Maybe Obligation
forall a. Typeable a =&gt; ([Word8] -&gt; a) -&gt; AnnPayload -&gt; Maybe a
</span><span class="hs-identifier hs-var">fromSerialized</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Obligation
forall a. Data a =&gt; [Word8] -&gt; a
</span><span class="hs-identifier hs-var">deserializeWithData</span></span><span> </span><span class="annot"><span class="annottext">AnnPayload
</span><a href="#local-6989586621679184954"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResultTarget, Obligation) -&gt; Maybe (ResultTarget, Obligation)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ResultTarget
</span><a href="Test.Inspection.Plugin.html#PrintAndAbort"><span class="hs-identifier hs-var">PrintAndAbort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679184955"><span class="hs-identifier hs-var">obl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Test.Inspection.Plugin.html#findObligationAnn"><span class="hs-identifier hs-var">findObligationAnn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Annotation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NamedTarget</span></span><span> </span><span id="local-6989586621679184959"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184959"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679184960"><span class="annot"><span class="annottext">AnnPayload
</span><a href="#local-6989586621679184960"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679184961"><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679184961"><span class="hs-identifier hs-var">obl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; Obligation) -&gt; AnnPayload -&gt; Maybe Obligation
forall a. Typeable a =&gt; ([Word8] -&gt; a) -&gt; AnnPayload -&gt; Maybe a
</span><span class="hs-identifier hs-var">fromSerialized</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; Obligation
forall a. Data a =&gt; [Word8] -&gt; a
</span><span class="hs-identifier hs-var">deserializeWithData</span></span><span> </span><span class="annot"><span class="annottext">AnnPayload
</span><a href="#local-6989586621679184960"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ResultTarget, Obligation) -&gt; Maybe (ResultTarget, Obligation)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ResultTarget
</span><a href="Test.Inspection.Plugin.html#StoreAt"><span class="hs-identifier hs-var">StoreAt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184959"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679184961"><span class="hs-identifier hs-var">obl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Test.Inspection.Plugin.html#findObligationAnn"><span class="hs-identifier hs-var">findObligationAnn</span></a></span><span> </span><span class="annot"><span class="annottext">Annotation
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ResultTarget, Obligation)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-type">prettyObligation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Module</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Inspection.html#Obligation"><span class="hs-identifier hs-type">Obligation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-99"></span><span id="prettyObligation"><span class="annot"><span class="annottext">prettyObligation :: Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var hs-var">prettyObligation</span></a></span></span><span> </span><span id="local-6989586621679184963"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679184963"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#Obligation"><span class="hs-identifier hs-type">Obligation</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679184965"><span id="local-6989586621679184966"><span id="local-6989586621679184967"><span id="local-6989586621679184968"><span id="local-6989586621679184969"><span id="local-6989586621679184970"><span class="annot"><span class="annottext">Bool
Maybe String
Maybe Loc
Name
Property
target :: Name
property :: Property
testName :: Maybe String
expectFail :: Bool
srcLoc :: Maybe Loc
storeResult :: Maybe String
target :: Obligation -&gt; Name
property :: Obligation -&gt; Property
testName :: Obligation -&gt; Maybe String
expectFail :: Obligation -&gt; Bool
srcLoc :: Obligation -&gt; Maybe Loc
storeResult :: Obligation -&gt; Maybe String
</span><a href="#local-6989586621679184965"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679184977"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679184977"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; (Loc -&gt; String) -&gt; Maybe Loc -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; String
</span><a href="Test.Inspection.Plugin.html#myPrettySrcLoc"><span class="hs-identifier hs-var">myPrettySrcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Loc
</span><a href="#local-6989586621679184969"><span class="hs-identifier hs-var">srcLoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679184980"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679184977"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679184980"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679184980"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679184967"><span class="hs-identifier hs-var">testName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679184981"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679184981"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679184981"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; String) -&gt; Name -&gt; Property -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyProperty"><span class="hs-identifier hs-var">prettyProperty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Name -&gt; String
</span><a href="Test.Inspection.Plugin.html#showTHName"><span class="hs-identifier hs-var">showTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679184963"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184965"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="#local-6989586621679184966"><span class="hs-identifier hs-var">property</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Test.Inspection.Plugin.html#prettyProperty"><span class="hs-identifier hs-type">prettyProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Inspection.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-107"></span><span id="prettyProperty"><span class="annot"><span class="annottext">prettyProperty :: (Name -&gt; String) -&gt; Name -&gt; Property -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyProperty"><span class="hs-identifier hs-var hs-var">prettyProperty</span></a></span></span><span> </span><span id="local-6989586621679184983"><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span></span><span> </span><span id="local-6989586621679184984"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Test.Inspection.html#EqualTo"><span class="hs-identifier hs-type">EqualTo</span></a></span><span> </span><span id="local-6989586621679184986"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184986"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span id="local-6989586621679184987"><span class="annot"><span class="annottext">Equivalence
</span><a href="#local-6989586621679184987"><span class="hs-identifier hs-var">eqv</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Equivalence -&gt; String
</span><a href="#local-6989586621679184988"><span class="hs-identifier hs-var">showEquiv</span></a></span><span> </span><span class="annot"><span class="annottext">Equivalence
</span><a href="#local-6989586621679184987"><span class="hs-identifier hs-var">eqv</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184986"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Test.Inspection.html#NoTypes"><span class="hs-identifier hs-type">NoTypes</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679184990"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184990"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; `hasNoType` &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184990"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Test.Inspection.html#NoTypes"><span class="hs-identifier hs-type">NoTypes</span></a></span><span> </span><span id="local-6989586621679184991"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679184991"><span class="hs-identifier hs-var">ts</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; mentions none of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; String) -&gt; [Name] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679184991"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">Property
</span><a href="Test.Inspection.html#NoAllocation"><span class="hs-identifier hs-var">NoAllocation</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; does not allocate&quot;</span></span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Test.Inspection.html#NoTypeClasses"><span class="hs-identifier hs-type">NoTypeClasses</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; does not contain dictionary values&quot;</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Test.Inspection.html#NoTypeClasses"><span class="hs-identifier hs-type">NoTypeClasses</span></a></span><span> </span><span id="local-6989586621679184995"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679184995"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; does not contain dictionary values except of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; String) -&gt; [Name] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679184995"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Test.Inspection.html#NoUseOf"><span class="hs-identifier hs-type">NoUseOf</span></a></span><span> </span><span id="local-6989586621679184997"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679184997"><span class="hs-identifier hs-var">ns</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; uses none of &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; String) -&gt; [Name] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679184997"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="annottext">Property
</span><a href="Test.Inspection.html#CoreOf"><span class="hs-identifier hs-var">CoreOf</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="#local-6989586621679184983"><span class="hs-identifier hs-var">showName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679184984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; core dump&quot;</span></span><span> </span><span class="hs-comment">-- :)</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>    </span><span id="local-6989586621679184988"><span class="annot"><span class="annottext">showEquiv :: Equivalence -&gt; String
</span><a href="#local-6989586621679184988"><span class="hs-identifier hs-var hs-var">showEquiv</span></a></span></span><span> </span><span class="annot"><span class="annottext">Equivalence
</span><a href="Test.Inspection.html#StrictEquiv"><span class="hs-identifier hs-var">StrictEquiv</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;===&quot;</span></span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="#local-6989586621679184988"><span class="hs-identifier hs-var">showEquiv</span></a></span><span> </span><span class="annot"><span class="annottext">Equivalence
</span><a href="Test.Inspection.html#IgnoreTypesAndTicksEquiv"><span class="hs-identifier hs-var">IgnoreTypesAndTicksEquiv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;==-&quot;</span></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="#local-6989586621679184988"><span class="hs-identifier hs-var">showEquiv</span></a></span><span> </span><span class="annot"><span class="annottext">Equivalence
</span><a href="Test.Inspection.html#UnorderedLetsEquiv"><span class="hs-identifier hs-var">UnorderedLetsEquiv</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;==~&quot;</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">-- | Like show, but omit the module name if it is he current module</span></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Test.Inspection.Plugin.html#showTHName"><span class="hs-identifier hs-type">showTHName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Module</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-123"></span><span id="showTHName"><span class="annot"><span class="annottext">showTHName :: Module -&gt; Name -&gt; String
</span><a href="Test.Inspection.Plugin.html#showTHName"><span class="hs-identifier hs-var hs-var">showTHName</span></a></span></span><span> </span><span id="local-6989586621679185002"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679185002"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span id="local-6989586621679185004"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679185004"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TH.NameQ</span></span><span> </span><span id="local-6989586621679185006"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679185006"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; String
</span><span class="hs-identifier hs-var">moduleNameString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><span class="hs-identifier hs-var">moduleName</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679185002"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName -&gt; String
</span><span class="hs-identifier hs-var">TH.modString</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679185006"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; String
</span><span class="hs-identifier hs-var">TH.occString</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679185004"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-125"></span><span class="annot"><a href="Test.Inspection.Plugin.html#showTHName"><span class="hs-identifier hs-var">showTHName</span></a></span><span> </span><span id="local-6989586621679185011"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679185011"><span class="hs-identifier hs-var">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span id="local-6989586621679185012"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679185012"><span class="hs-identifier hs-var">occ</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TH.NameG</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PkgName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679185014"><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679185014"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; String
</span><span class="hs-identifier hs-var">moduleNameString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; ModuleName
forall unit. GenModule unit -&gt; ModuleName
</span><span class="hs-identifier hs-var">moduleName</span></span><span> </span><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679185011"><span class="hs-identifier hs-var">mod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModName -&gt; String
</span><span class="hs-identifier hs-var">TH.modString</span></span><span> </span><span class="annot"><span class="annottext">ModName
</span><a href="#local-6989586621679185014"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OccName -&gt; String
</span><span class="hs-identifier hs-var">TH.occString</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679185012"><span class="hs-identifier hs-var">occ</span></a></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Test.Inspection.Plugin.html#showTHName"><span class="hs-identifier hs-var">showTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Module
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679185015"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185015"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185015"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">data</span><span> </span><span id="Stat"><span class="annot"><a href="Test.Inspection.Plugin.html#Stat"><span class="hs-identifier hs-var">Stat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExpSuccess"><span class="annot"><a href="Test.Inspection.Plugin.html#ExpSuccess"><span class="hs-identifier hs-var">ExpSuccess</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="ExpFailure"><span class="annot"><a href="Test.Inspection.Plugin.html#ExpFailure"><span class="hs-identifier hs-var">ExpFailure</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="UnexpSuccess"><span class="annot"><a href="Test.Inspection.Plugin.html#UnexpSuccess"><span class="hs-identifier hs-var">UnexpSuccess</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="UnexpFailure"><span class="annot"><a href="Test.Inspection.Plugin.html#UnexpFailure"><span class="hs-identifier hs-var">UnexpFailure</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="StoredResult"><span class="annot"><a href="Test.Inspection.Plugin.html#StoredResult"><span class="hs-identifier hs-var">StoredResult</span></a></span></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185023"><span id="local-6989586621679185029"><span id="local-6989586621679185035"><span id="local-6989586621679185044"><span id="local-6989586621679185046"><span id="local-6989586621679185050"><span id="local-6989586621679185054"><span id="local-6989586621679185058"><span class="annot"><span class="annottext">Int -&gt; Stat
Stat -&gt; Int
Stat -&gt; [Stat]
Stat -&gt; Stat
Stat -&gt; Stat -&gt; [Stat]
Stat -&gt; Stat -&gt; Stat -&gt; [Stat]
(Stat -&gt; Stat)
-&gt; (Stat -&gt; Stat)
-&gt; (Int -&gt; Stat)
-&gt; (Stat -&gt; Int)
-&gt; (Stat -&gt; [Stat])
-&gt; (Stat -&gt; Stat -&gt; [Stat])
-&gt; (Stat -&gt; Stat -&gt; [Stat])
-&gt; (Stat -&gt; Stat -&gt; Stat -&gt; [Stat])
-&gt; Enum Stat
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: Stat -&gt; Stat
succ :: Stat -&gt; Stat
$cpred :: Stat -&gt; Stat
pred :: Stat -&gt; Stat
$ctoEnum :: Int -&gt; Stat
toEnum :: Int -&gt; Stat
$cfromEnum :: Stat -&gt; Int
fromEnum :: Stat -&gt; Int
$cenumFrom :: Stat -&gt; [Stat]
enumFrom :: Stat -&gt; [Stat]
$cenumFromThen :: Stat -&gt; Stat -&gt; [Stat]
enumFromThen :: Stat -&gt; Stat -&gt; [Stat]
$cenumFromTo :: Stat -&gt; Stat -&gt; [Stat]
enumFromTo :: Stat -&gt; Stat -&gt; [Stat]
$cenumFromThenTo :: Stat -&gt; Stat -&gt; Stat -&gt; [Stat]
enumFromThenTo :: Stat -&gt; Stat -&gt; Stat -&gt; [Stat]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185062"><span id="local-6989586621679185064"><span class="annot"><span class="annottext">Stat -&gt; Stat -&gt; Bool
(Stat -&gt; Stat -&gt; Bool) -&gt; (Stat -&gt; Stat -&gt; Bool) -&gt; Eq Stat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Stat -&gt; Stat -&gt; Bool
== :: Stat -&gt; Stat -&gt; Bool
$c/= :: Stat -&gt; Stat -&gt; Bool
/= :: Stat -&gt; Stat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185070"><span id="local-6989586621679185072"><span id="local-6989586621679185074"><span id="local-6989586621679185077"><span id="local-6989586621679185080"><span id="local-6989586621679185083"><span id="local-6989586621679185086"><span class="annot"><span class="annottext">Eq Stat
Eq Stat =&gt;
(Stat -&gt; Stat -&gt; Ordering)
-&gt; (Stat -&gt; Stat -&gt; Bool)
-&gt; (Stat -&gt; Stat -&gt; Bool)
-&gt; (Stat -&gt; Stat -&gt; Bool)
-&gt; (Stat -&gt; Stat -&gt; Bool)
-&gt; (Stat -&gt; Stat -&gt; Stat)
-&gt; (Stat -&gt; Stat -&gt; Stat)
-&gt; Ord Stat
Stat -&gt; Stat -&gt; Bool
Stat -&gt; Stat -&gt; Ordering
Stat -&gt; Stat -&gt; Stat
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Stat -&gt; Stat -&gt; Ordering
compare :: Stat -&gt; Stat -&gt; Ordering
$c&lt; :: Stat -&gt; Stat -&gt; Bool
&lt; :: Stat -&gt; Stat -&gt; Bool
$c&lt;= :: Stat -&gt; Stat -&gt; Bool
&lt;= :: Stat -&gt; Stat -&gt; Bool
$c&gt; :: Stat -&gt; Stat -&gt; Bool
&gt; :: Stat -&gt; Stat -&gt; Bool
$c&gt;= :: Stat -&gt; Stat -&gt; Bool
&gt;= :: Stat -&gt; Stat -&gt; Bool
$cmax :: Stat -&gt; Stat -&gt; Stat
max :: Stat -&gt; Stat -&gt; Stat
$cmin :: Stat -&gt; Stat -&gt; Stat
min :: Stat -&gt; Stat -&gt; Stat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185090"><span id="local-6989586621679185092"><span class="annot"><span class="annottext">Stat
Stat -&gt; Stat -&gt; Bounded Stat
forall a. a -&gt; a -&gt; Bounded a
$cminBound :: Stat
minBound :: Stat
$cmaxBound :: Stat
maxBound :: Stat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span class="hs-keyword">type</span><span> </span><span id="Stats"><span class="annot"><a href="Test.Inspection.Plugin.html#Stats"><span class="hs-identifier hs-var">Stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#Stat"><span class="hs-identifier hs-type">Stat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">type</span><span> </span><span id="Updates"><span class="annot"><a href="Test.Inspection.Plugin.html#Updates"><span class="hs-identifier hs-var">Updates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Test.Inspection.Plugin.html#tick"><span class="hs-identifier hs-type">tick</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#Stat"><span class="hs-identifier hs-type">Stat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#Stats"><span class="hs-identifier hs-type">Stats</span></a></span><span>
</span><span id="line-136"></span><span id="tick"><span class="annot"><span class="annottext">tick :: Stat -&gt; Stats
</span><a href="Test.Inspection.Plugin.html#tick"><span class="hs-identifier hs-var hs-var">tick</span></a></span></span><span> </span><span id="local-6989586621679185096"><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185096"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Int -&gt; Stats
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185096"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Test.Inspection.Plugin.html#checkObligation"><span class="hs-identifier hs-type">checkObligation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#ReportingMode"><span class="hs-identifier hs-type">ReportingMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#ResultTarget"><span class="hs-identifier hs-type">ResultTarget</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.html#Obligation"><span class="hs-identifier hs-type">Obligation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#Updates"><span class="hs-identifier hs-type">Updates</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#Stats"><span class="hs-identifier hs-type">Stats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span id="checkObligation"><span class="annot"><span class="annottext">checkObligation :: ReportingMode
-&gt; ModGuts -&gt; (ResultTarget, Obligation) -&gt; CoreM (Updates, Stats)
</span><a href="Test.Inspection.Plugin.html#checkObligation"><span class="hs-identifier hs-var hs-var">checkObligation</span></a></span></span><span> </span><span id="local-6989586621679185099"><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679185099"><span class="hs-identifier hs-var">report</span></a></span></span><span> </span><span id="local-6989586621679185100"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185101"><span class="annot"><span class="annottext">ResultTarget
</span><a href="#local-6989586621679185101"><span class="hs-identifier hs-var">reportTarget</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185102"><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679185103"><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621679185103"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Property -&gt; CoreM CheckResult
</span><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-var">checkProperty</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Obligation -&gt; Name
</span><a href="Test.Inspection.html#target"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Obligation -&gt; Property
</span><a href="Test.Inspection.html#property"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ResultTarget
</span><a href="#local-6989586621679185101"><span class="hs-identifier hs-var">reportTarget</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="annottext">ResultTarget
</span><a href="Test.Inspection.Plugin.html#PrintAndAbort"><span class="hs-identifier hs-var">PrintAndAbort</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>            </span><span id="local-6989586621679185104"><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185104"><span class="hs-identifier hs-var">category</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621679185103"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Obligation -&gt; Bool
</span><a href="Test.Inspection.html#expectFail"><span class="hs-identifier hs-var">expectFail</span></a></span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>                </span><span class="hs-comment">-- Property holds</span><span>
</span><span id="line-146"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; CoreM () -&gt; CoreM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679185099"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">ReportingMode -&gt; ReportingMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="Test.Inspection.Plugin.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreM () -&gt; CoreM ()) -&gt; CoreM () -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-148"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsgS</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; CoreM ()) -&gt; String -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">expSuccess</span></a></span><span>
</span><span id="line-149"></span><span>                    </span><span class="annot"><span class="annottext">Stat -&gt; CoreM Stat
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#ExpSuccess"><span class="hs-identifier hs-var">ExpSuccess</span></a></span><span>
</span><span id="line-150"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsgS</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; CoreM ()) -&gt; String -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185110"><span class="hs-identifier hs-var">unexpSuccess</span></a></span><span>
</span><span id="line-152"></span><span>                    </span><span class="annot"><span class="annottext">Stat -&gt; CoreM Stat
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#UnexpSuccess"><span class="hs-identifier hs-var">UnexpSuccess</span></a></span><span>
</span><span id="line-153"></span><span>                </span><span class="hs-comment">-- Property holds, with extra message</span><span>
</span><span id="line-154"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#ResSuccessWithMessage"><span class="hs-identifier hs-type">ResSuccessWithMessage</span></a></span><span> </span><span id="local-6989586621679185112"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185112"><span class="hs-identifier hs-var">reportDoc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; CoreM () -&gt; CoreM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679185099"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">ReportingMode -&gt; ReportingMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="Test.Inspection.Plugin.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreM () -&gt; CoreM ()) -&gt; CoreM () -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsgS</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; CoreM ()) -&gt; String -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">expSuccess</span></a></span><span>
</span><span id="line-157"></span><span>                        </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsg</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185112"><span class="hs-identifier hs-var">reportDoc</span></a></span><span>
</span><span id="line-158"></span><span>                    </span><span class="annot"><span class="annottext">Stat -&gt; CoreM Stat
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#ExpSuccess"><span class="hs-identifier hs-var">ExpSuccess</span></a></span><span>
</span><span id="line-159"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#ResSuccessWithMessage"><span class="hs-identifier hs-type">ResSuccessWithMessage</span></a></span><span> </span><span id="local-6989586621679185114"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185114"><span class="hs-identifier hs-var">reportDoc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsgS</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; CoreM ()) -&gt; String -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185110"><span class="hs-identifier hs-var">unexpSuccess</span></a></span><span>
</span><span id="line-161"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsg</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185114"><span class="hs-identifier hs-var">reportDoc</span></a></span><span>
</span><span id="line-162"></span><span>                    </span><span class="annot"><span class="annottext">Stat -&gt; CoreM Stat
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#UnexpSuccess"><span class="hs-identifier hs-var">UnexpSuccess</span></a></span><span>
</span><span id="line-163"></span><span>                </span><span class="hs-comment">-- Property does not hold</span><span>
</span><span id="line-164"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-type">ResFailure</span></a></span><span> </span><span id="local-6989586621679185116"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185116"><span class="hs-identifier hs-var">reportDoc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsgS</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; CoreM ()) -&gt; String -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185117"><span class="hs-identifier hs-var">unexpFailure</span></a></span><span>
</span><span id="line-166"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsg</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM ()) -&gt; SDoc -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185116"><span class="hs-identifier hs-var">reportDoc</span></a></span><span>
</span><span id="line-167"></span><span>                    </span><span class="annot"><span class="annottext">Stat -&gt; CoreM Stat
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#UnexpFailure"><span class="hs-identifier hs-var">UnexpFailure</span></a></span><span>
</span><span id="line-168"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-type">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; CoreM () -&gt; CoreM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679185099"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">ReportingMode -&gt; ReportingMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="Test.Inspection.Plugin.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreM () -&gt; CoreM ()) -&gt; CoreM () -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-170"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsgS</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; CoreM ()) -&gt; String -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185118"><span class="hs-identifier hs-var">expFailure</span></a></span><span>
</span><span id="line-171"></span><span>                    </span><span class="annot"><span class="annottext">Stat -&gt; CoreM Stat
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#ExpFailure"><span class="hs-identifier hs-var">ExpFailure</span></a></span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">(Updates, Stats) -&gt; CoreM (Updates, Stats)
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Stats
</span><a href="Test.Inspection.Plugin.html#tick"><span class="hs-identifier hs-var">tick</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185104"><span class="hs-identifier hs-var">category</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="Test.Inspection.Plugin.html#StoreAt"><span class="hs-identifier hs-type">StoreAt</span></a></span><span> </span><span id="local-6989586621679185119"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185119"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>            </span><span id="local-6989586621679185120"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621679185120"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreM DynFlags
forall (m :: * -&gt; *). HasDynFlags m =&gt; m DynFlags
</span><span class="hs-identifier hs-var">getDynFlags</span></span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185127"><span class="annot"><span class="annottext">result :: Result
</span><a href="#local-6989586621679185127"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="#local-6989586621679185103"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-176"></span><span>                    </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Result
</span><a href="Test.Inspection.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Result) -&gt; String -&gt; Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; SDoc -&gt; String
</span><span class="hs-identifier hs-var">showSDoc</span></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621679185120"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; String) -&gt; SDoc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-177"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">expSuccess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>                    </span><span class="annot"><a href="Test.Inspection.Plugin.html#ResSuccessWithMessage"><span class="hs-identifier hs-type">ResSuccessWithMessage</span></a></span><span> </span><span id="local-6989586621679185131"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185131"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Result
</span><a href="Test.Inspection.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Result) -&gt; String -&gt; Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; SDoc -&gt; String
</span><span class="hs-identifier hs-var">showSDoc</span></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621679185120"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; String) -&gt; SDoc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-179"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var">expSuccess</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">$$</span></span><span>
</span><span id="line-180"></span><span>                        </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185131"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-181"></span><span>                    </span><span class="annot"><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-type">ResFailure</span></a></span><span> </span><span id="local-6989586621679185133"><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185133"><span class="hs-identifier hs-var">reportMsg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Result
</span><a href="Test.Inspection.html#Failure"><span class="hs-identifier hs-var">Failure</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Result) -&gt; String -&gt; Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; SDoc -&gt; String
</span><span class="hs-identifier hs-var">showSDoc</span></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621679185120"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; String) -&gt; SDoc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-182"></span><span>                        </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module -&gt; Obligation -&gt; String -&gt; String
</span><a href="Test.Inspection.Plugin.html#prettyObligation"><span class="hs-identifier hs-var">prettyObligation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; Module
</span><span class="hs-identifier hs-var">mg_module</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185100"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Obligation
</span><a href="#local-6989586621679185102"><span class="hs-identifier hs-var">obl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185117"><span class="hs-identifier hs-var">unexpFailure</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">$$</span></span><span>
</span><span id="line-183"></span><span>                        </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185133"><span class="hs-identifier hs-var">reportMsg</span></a></span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">(Updates, Stats) -&gt; CoreM (Updates, Stats)
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185119"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679185127"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Stats
</span><a href="Test.Inspection.Plugin.html#tick"><span class="hs-identifier hs-var">tick</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#StoredResult"><span class="hs-identifier hs-var">StoredResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679185109"><span class="annot"><span class="annottext">expSuccess :: String
</span><a href="#local-6989586621679185109"><span class="hs-identifier hs-var hs-var">expSuccess</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;passed.&quot;</span></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679185110"><span class="annot"><span class="annottext">unexpSuccess :: String
</span><a href="#local-6989586621679185110"><span class="hs-identifier hs-var hs-var">unexpSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;passed unexpectedly!&quot;</span></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679185117"><span class="annot"><span class="annottext">unexpFailure :: String
</span><a href="#local-6989586621679185117"><span class="hs-identifier hs-var hs-var">unexpFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;failed:&quot;</span></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679185118"><span class="annot"><span class="annottext">expFailure :: String
</span><a href="#local-6989586621679185118"><span class="hs-identifier hs-var hs-var">expFailure</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;failed expectedly.&quot;</span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">data</span><span> </span><span id="CheckResult"><span class="annot"><a href="Test.Inspection.Plugin.html#CheckResult"><span class="hs-identifier hs-var">CheckResult</span></a></span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="ResSuccess"><span class="annot"><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ResSuccessWithMessage"><span class="annot"><a href="Test.Inspection.Plugin.html#ResSuccessWithMessage"><span class="hs-identifier hs-var">ResSuccessWithMessage</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SDoc</span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="ResFailure"><span class="annot"><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SDoc</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-type">lookupNameInGuts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreExpr</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span id="lookupNameInGuts"><span class="annot"><span class="annottext">lookupNameInGuts :: ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var hs-var">lookupNameInGuts</span></a></span></span><span> </span><span id="local-6989586621679185137"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185137"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span id="local-6989586621679185138"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185138"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; Maybe (CoreBndr, CoreExpr)
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185140"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185141"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185140"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185140"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679185141"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185141"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Bind CoreBndr] -&gt; [(CoreBndr, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><span class="hs-identifier hs-var">flattenBinds</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Bind CoreBndr]
</span><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185137"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreBndr -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><span class="hs-identifier hs-var">getName</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185140"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185138"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Test.Inspection.Plugin.html#updateNameInGuts"><span class="hs-identifier hs-type">updateNameInGuts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span>
</span><span id="line-206"></span><span id="updateNameInGuts"><span class="annot"><span class="annottext">updateNameInGuts :: Name -&gt; CoreExpr -&gt; ModGuts -&gt; ModGuts
</span><a href="Test.Inspection.Plugin.html#updateNameInGuts"><span class="hs-identifier hs-var hs-var">updateNameInGuts</span></a></span></span><span> </span><span id="local-6989586621679185146"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185146"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679185147"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185147"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621679185148"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185148"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185148"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.Plugin.html#updateNameInGut"><span class="hs-identifier hs-type">updateNameInGut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679185146"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679185147"><span class="hs-identifier hs-type">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><a href="#local-6989586621679185148"><span class="hs-identifier hs-type">guts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Test.Inspection.Plugin.html#updateNameInGut"><span class="hs-identifier hs-type">updateNameInGut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreExpr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreBind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreBind</span></span><span>
</span><span id="line-210"></span><span id="updateNameInGut"><span class="annot"><span class="annottext">updateNameInGut :: Name -&gt; CoreExpr -&gt; Bind CoreBndr -&gt; Bind CoreBndr
</span><a href="Test.Inspection.Plugin.html#updateNameInGut"><span class="hs-identifier hs-var hs-var">updateNameInGut</span></a></span></span><span> </span><span id="local-6989586621679185151"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185151"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679185152"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185152"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonRec</span></span><span> </span><span id="local-6989586621679185154"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185154"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CoreBndr -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><span class="hs-identifier hs-var">getName</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185154"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185151"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreBndr -&gt; CoreExpr -&gt; Bind CoreBndr
forall b. b -&gt; Expr b -&gt; Bind b
</span><span class="hs-identifier hs-var">NonRec</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185154"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185152"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Test.Inspection.Plugin.html#updateNameInGut"><span class="hs-identifier hs-var">updateNameInGut</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679185155"><span class="annot"><span class="annottext">Bind CoreBndr
</span><a href="#local-6989586621679185155"><span class="hs-identifier hs-var">bind</span></a></span></span><span>                          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bind CoreBndr
</span><a href="#local-6989586621679185155"><span class="hs-identifier hs-var">bind</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-type">checkProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Inspection.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#CheckResult"><span class="hs-identifier hs-type">CheckResult</span></a></span><span>
</span><span id="line-214"></span><span id="checkProperty"><span class="annot"><span class="annottext">checkProperty :: ModGuts -&gt; Name -&gt; Property -&gt; CoreM CheckResult
</span><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-var hs-var">checkProperty</span></a></span></span><span> </span><span id="local-6989586621679185156"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185156"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span id="local-6989586621679185157"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185157"><span class="hs-identifier hs-var">thn1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#EqualTo"><span class="hs-identifier hs-type">EqualTo</span></a></span><span> </span><span id="local-6989586621679185158"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185158"><span class="hs-identifier hs-var">thn2</span></a></span></span><span> </span><span id="local-6989586621679185159"><span class="annot"><span class="annottext">Equivalence
</span><a href="#local-6989586621679185159"><span class="hs-identifier hs-var">ignore_types</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679185160"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185160"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185157"><span class="hs-identifier hs-var">thn1</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679185162"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185162"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185158"><span class="hs-identifier hs-var">thn2</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185163"><span class="annot"><span class="annottext">p1 :: Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185163"><span class="hs-identifier hs-var hs-var">p1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var">lookupNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185156"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185160"><span class="hs-identifier hs-var">n1</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185164"><span class="annot"><span class="annottext">p2 :: Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185164"><span class="hs-identifier hs-var hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var">lookupNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185156"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185162"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185160"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185162"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-222"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-223"></span><span>       </span><span class="hs-comment">-- Ok if one points to another</span><span>
</span><span id="line-224"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreBndr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span id="local-6989586621679185166"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185166"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185163"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreBndr -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><span class="hs-identifier hs-var">getName</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185166"><span class="hs-identifier hs-var">other</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185162"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-225"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-226"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreBndr
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Var</span></span><span> </span><span id="local-6989586621679185167"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185167"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185164"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreBndr -&gt; Name
forall a. NamedThing a =&gt; a -&gt; Name
</span><span class="hs-identifier hs-var">getName</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185167"><span class="hs-identifier hs-var">other</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185160"><span class="hs-identifier hs-var">n1</span></a></span><span>
</span><span id="line-227"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-228"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185168"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185168"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185163"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-229"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185169"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185169"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185164"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-230"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185170"><span class="annot"><span class="annottext">slice1 :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185170"><span class="hs-identifier hs-var hs-var">slice1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185172"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185168"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-231"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185173"><span class="annot"><span class="annottext">slice2 :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185173"><span class="hs-identifier hs-var hs-var">slice2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185172"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185169"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-232"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Equivalence
-&gt; [(CoreBndr, CoreExpr)] -&gt; [(CoreBndr, CoreExpr)] -&gt; Bool
</span><a href="Test.Inspection.Core.html#eqSlice"><span class="hs-identifier hs-var">eqSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Equivalence
</span><a href="#local-6989586621679185159"><span class="hs-identifier hs-var">ignore_types</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185170"><span class="hs-identifier hs-var">slice1</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185173"><span class="hs-identifier hs-var">slice2</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-comment">-- OK if they have the same expression</span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-comment">-- Not ok if the expression differ</span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; [(CoreBndr, CoreExpr)] -&gt; SDoc
</span><a href="Test.Inspection.Core.html#pprSliceDifference"><span class="hs-identifier hs-var">pprSliceDifference</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185170"><span class="hs-identifier hs-var">slice1</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185173"><span class="hs-identifier hs-var">slice2</span></a></span><span>
</span><span id="line-237"></span><span>       </span><span class="hs-comment">-- Not ok if both names are bound externally</span><span>
</span><span id="line-238"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185163"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-239"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185164"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-240"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185160"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185162"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span>
</span><span id="line-241"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;are different external names&quot;</span></span><span>
</span><span id="line-242"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185163"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-243"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185160"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is an external name&quot;</span></span><span>
</span><span id="line-244"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><a href="#local-6989586621679185164"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-245"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185162"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is an external name&quot;</span></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679185172"><span class="annot"><span class="annottext">binds :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185172"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bind CoreBndr] -&gt; [(CoreBndr, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><span class="hs-identifier hs-var">flattenBinds</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Bind CoreBndr]
</span><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185156"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-var">checkProperty</span></a></span><span> </span><span id="local-6989586621679185179"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185179"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span id="local-6989586621679185180"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185180"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#NoUseOf"><span class="hs-identifier hs-type">NoUseOf</span></a></span><span> </span><span id="local-6989586621679185181"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185181"><span class="hs-identifier hs-var">thns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>    </span><span id="local-6989586621679185182"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185182"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185180"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679185183"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185183"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; CoreM Name) -&gt; [Name] -&gt; CoreM [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185181"><span class="hs-identifier hs-var">thns</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var">lookupNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185179"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185182"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-253"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185182"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not a local name&quot;</span></span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185185"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185185"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; [Name] -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Core.html#freeOfTerm"><span class="hs-identifier hs-var">freeOfTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185187"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185185"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185183"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-255"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreBndr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; SDoc
</span><a href="Test.Inspection.Core.html#pprSlice"><span class="hs-identifier hs-var">pprSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185187"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185185"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679185187"><span class="annot"><span class="annottext">binds :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185187"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bind CoreBndr] -&gt; [(CoreBndr, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><span class="hs-identifier hs-var">flattenBinds</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Bind CoreBndr]
</span><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185179"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-var">checkProperty</span></a></span><span> </span><span id="local-6989586621679185189"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185189"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span id="local-6989586621679185190"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185190"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#NoTypes"><span class="hs-identifier hs-type">NoTypes</span></a></span><span> </span><span id="local-6989586621679185191"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185191"><span class="hs-identifier hs-var">thts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679185192"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185192"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185190"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679185193"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185193"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; CoreM Name) -&gt; [Name] -&gt; CoreM [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185191"><span class="hs-identifier hs-var">thts</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var">lookupNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185189"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185192"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185192"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not a local name&quot;</span></span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185194"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185194"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; [Name] -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Core.html#freeOfType"><span class="hs-identifier hs-var">freeOfType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185196"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185194"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185193"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">(CoreBndr, CoreExpr)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; SDoc
</span><a href="Test.Inspection.Core.html#pprSlice"><span class="hs-identifier hs-var">pprSlice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185196"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185194"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>            </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679185196"><span class="annot"><span class="annottext">binds :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185196"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bind CoreBndr] -&gt; [(CoreBndr, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><span class="hs-identifier hs-var">flattenBinds</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Bind CoreBndr]
</span><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185189"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-var">checkProperty</span></a></span><span> </span><span id="local-6989586621679185197"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185197"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span id="local-6989586621679185198"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185198"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="Test.Inspection.html#NoAllocation"><span class="hs-identifier hs-var">NoAllocation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679185199"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185199"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185198"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var">lookupNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185197"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185199"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185199"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not a local name&quot;</span></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185200"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185200"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Core.html#doesNotAllocate"><span class="hs-identifier hs-var">doesNotAllocate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185202"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185200"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185203"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185203"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679185204"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185204"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><span class="hs-identifier hs-var">nest</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreBndr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185203"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185204"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679185202"><span class="annot"><span class="annottext">binds :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185202"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bind CoreBndr] -&gt; [(CoreBndr, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><span class="hs-identifier hs-var">flattenBinds</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Bind CoreBndr]
</span><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185197"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-var">checkProperty</span></a></span><span> </span><span id="local-6989586621679185206"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185206"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span id="local-6989586621679185207"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185207"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#NoTypeClasses"><span class="hs-identifier hs-type">NoTypeClasses</span></a></span><span> </span><span id="local-6989586621679185208"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185208"><span class="hs-identifier hs-var">thts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679185209"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185209"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185207"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679185210"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185210"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; CoreM Name) -&gt; [Name] -&gt; CoreM [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185208"><span class="hs-identifier hs-var">thts</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var">lookupNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185206"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not a local name&quot;</span></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185211"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185211"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
-&gt; [Name] -&gt; Maybe (CoreBndr, CoreExpr, [TyCon])
</span><a href="Test.Inspection.Core.html#doesNotContainTypeClasses"><span class="hs-identifier hs-var">doesNotContainTypeClasses</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185213"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185211"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679185210"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185214"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185214"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679185215"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185215"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679185216"><span class="annot"><span class="annottext">[TyCon]
</span><a href="#local-6989586621679185216"><span class="hs-identifier hs-var">tc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span>
</span><span id="line-285"></span><span>                </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><span class="hs-identifier hs-var">nest</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><span class="hs-identifier hs-var">vcat</span></span><span>
</span><span id="line-286"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Found type classes: &quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TyCon] -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">[TyCon]
</span><a href="#local-6989586621679185216"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-287"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreBndr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185214"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185215"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-288"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-289"></span><span>            </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr, [TyCon])
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccess"><span class="hs-identifier hs-var">ResSuccess</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679185213"><span class="annot"><span class="annottext">binds :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185213"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bind CoreBndr] -&gt; [(CoreBndr, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><span class="hs-identifier hs-var">flattenBinds</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Bind CoreBndr]
</span><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185206"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Test.Inspection.Plugin.html#checkProperty"><span class="hs-identifier hs-var">checkProperty</span></a></span><span> </span><span id="local-6989586621679185218"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185218"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span id="local-6989586621679185219"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185219"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="Test.Inspection.html#CoreOf"><span class="hs-identifier hs-var">CoreOf</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679185220"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185220"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185219"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; Name -&gt; Maybe (CoreBndr, CoreExpr)
</span><a href="Test.Inspection.Plugin.html#lookupNameInGuts"><span class="hs-identifier hs-var">lookupNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185218"><span class="hs-identifier hs-var">guts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185220"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">Maybe (CoreBndr, CoreExpr)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; (SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResFailure"><span class="hs-identifier hs-var">ResFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM CheckResult) -&gt; SDoc -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185220"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is not a local name&quot;</span></span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185221"><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185221"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185222"><span class="annot"><span class="annottext">s :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185222"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; CoreBndr -&gt; [(CoreBndr, CoreExpr)]
</span><a href="Test.Inspection.Core.html#slice"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185223"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">CoreBndr
</span><a href="#local-6989586621679185221"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="annottext">CheckResult -&gt; CoreM CheckResult
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CheckResult -&gt; CoreM CheckResult)
-&gt; CheckResult -&gt; CoreM CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; CheckResult
</span><a href="Test.Inspection.Plugin.html#ResSuccessWithMessage"><span class="hs-identifier hs-var">ResSuccessWithMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CheckResult) -&gt; SDoc -&gt; CheckResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><span class="hs-identifier hs-var">nest</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)] -&gt; SDoc
</span><a href="Test.Inspection.Core.html#pprSlice"><span class="hs-identifier hs-var">pprSlice</span></a></span><span> </span><span class="annot"><span class="annottext">[(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185222"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679185223"><span class="annot"><span class="annottext">binds :: [(CoreBndr, CoreExpr)]
</span><a href="#local-6989586621679185223"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bind CoreBndr] -&gt; [(CoreBndr, CoreExpr)]
forall b. [Bind b] -&gt; [(b, Expr b)]
</span><span class="hs-identifier hs-var">flattenBinds</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModGuts -&gt; [Bind CoreBndr]
</span><span class="hs-identifier hs-var">mg_binds</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185218"><span class="hs-identifier hs-var">guts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-type">fromTHName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-302"></span><span id="fromTHName"><span class="annot"><span class="annottext">fromTHName :: Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var hs-var">fromTHName</span></a></span></span><span> </span><span id="local-6989586621679185224"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185224"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM (Maybe Name)
</span><span class="hs-identifier hs-var">thNameToGhcName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185224"><span class="hs-identifier hs-var">thn</span></a></span><span> </span><span class="annot"><span class="annottext">CoreM (Maybe Name) -&gt; (Maybe Name -&gt; CoreM Name) -&gt; CoreM Name
forall a b. CoreM a -&gt; (a -&gt; CoreM b) -&gt; CoreM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">Maybe Name
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>        </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><span class="hs-identifier hs-var">errorMsg</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM ()) -&gt; SDoc -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Could not resolve TH name&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185224"><span class="hs-identifier hs-var">thn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">IO Name -&gt; CoreM Name
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Name -&gt; CoreM Name) -&gt; IO Name -&gt; CoreM Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO Name
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span> </span><span class="hs-comment">-- kill the compiler. Is there a nicer way?</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679185229"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185229"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185229"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><a href="Test.Inspection.Plugin.html#storeResults"><span class="hs-identifier hs-type">storeResults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#Updates"><span class="hs-identifier hs-type">Updates</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span>
</span><span id="line-309"></span><span id="storeResults"><span class="annot"><span class="annottext">storeResults :: Updates -&gt; CorePluginPass
</span><a href="Test.Inspection.Plugin.html#storeResults"><span class="hs-identifier hs-var hs-var">storeResults</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModGuts -&gt; Updates -&gt; CoreM ModGuts) -&gt; Updates -&gt; CorePluginPass
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ModGuts -&gt; (Name, Result) -&gt; CoreM ModGuts)
-&gt; ModGuts -&gt; Updates -&gt; CoreM ModGuts
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Name, Result) -&gt; CorePluginPass)
-&gt; ModGuts -&gt; (Name, Result) -&gt; CoreM ModGuts
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Result -&gt; CorePluginPass)
-&gt; (Name, Result) -&gt; CorePluginPass
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Result -&gt; CorePluginPass
</span><a href="#local-6989586621679185234"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="#local-6989586621679185234"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Inspection.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span>
</span><span id="line-312"></span><span>    </span><span id="local-6989586621679185234"><span class="annot"><span class="annottext">go :: Name -&gt; Result -&gt; CorePluginPass
</span><a href="#local-6989586621679185234"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679185235"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185235"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679185236"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679185236"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679185237"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185237"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-313"></span><span>        </span><span id="local-6989586621679185238"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185238"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; CoreM CoreExpr
</span><a href="Test.Inspection.Plugin.html#resultToExpr"><span class="hs-identifier hs-var">resultToExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679185236"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">CorePluginPass
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">CorePluginPass -&gt; CorePluginPass
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreExpr -&gt; ModGuts -&gt; ModGuts
</span><a href="Test.Inspection.Plugin.html#updateNameInGuts"><span class="hs-identifier hs-var">updateNameInGuts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185235"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621679185238"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185237"><span class="hs-identifier hs-var">guts</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Test.Inspection.Plugin.html#dcExpr"><span class="hs-identifier hs-type">dcExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreExpr</span></span><span>
</span><span id="line-317"></span><span id="dcExpr"><span class="annot"><span class="annottext">dcExpr :: Name -&gt; CoreM CoreExpr
</span><a href="Test.Inspection.Plugin.html#dcExpr"><span class="hs-identifier hs-var hs-var">dcExpr</span></a></span></span><span> </span><span id="local-6989586621679185241"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185241"><span class="hs-identifier hs-var">thn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679185242"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185242"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM Name
</span><a href="Test.Inspection.Plugin.html#fromTHName"><span class="hs-identifier hs-var">fromTHName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185241"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679185243"><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621679185243"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM DataCon
forall (m :: * -&gt; *). MonadThings m =&gt; Name -&gt; m DataCon
</span><span class="hs-identifier hs-var">lookupDataCon</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679185242"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreM CoreExpr
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreM CoreExpr) -&gt; CoreExpr -&gt; CoreM CoreExpr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreBndr -&gt; CoreExpr
forall b. CoreBndr -&gt; Expr b
</span><span class="hs-identifier hs-var">Var</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataCon -&gt; CoreBndr
</span><span class="hs-identifier hs-var">dataConWrapId</span></span><span> </span><span class="annot"><span class="annottext">DataCon
</span><a href="#local-6989586621679185243"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Test.Inspection.Plugin.html#resultToExpr"><span class="hs-identifier hs-type">resultToExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Inspection.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreExpr</span></span><span>
</span><span id="line-323"></span><span id="resultToExpr"><span class="annot"><span class="annottext">resultToExpr :: Result -&gt; CoreM CoreExpr
</span><a href="Test.Inspection.Plugin.html#resultToExpr"><span class="hs-identifier hs-var hs-var">resultToExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679185246"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185246"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><span class="hs-identifier hs-var">App</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr -&gt; CoreExpr)
-&gt; CoreM CoreExpr -&gt; CoreM (CoreExpr -&gt; CoreExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM CoreExpr
</span><a href="Test.Inspection.Plugin.html#dcExpr"><span class="hs-identifier hs-var">dcExpr</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Success</span><span> </span><span class="annot"><span class="annottext">CoreM (CoreExpr -&gt; CoreExpr) -&gt; CoreM CoreExpr -&gt; CoreM CoreExpr
forall a b. CoreM (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; CoreM CoreExpr
forall (m :: * -&gt; *). MonadThings m =&gt; String -&gt; m CoreExpr
</span><span class="hs-identifier hs-var">mkStringExpr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185246"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-324"></span><span class="annot"><a href="Test.Inspection.Plugin.html#resultToExpr"><span class="hs-identifier hs-var">resultToExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Inspection.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span id="local-6989586621679185250"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185250"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; CoreExpr -&gt; CoreExpr
forall b. Expr b -&gt; Expr b -&gt; Expr b
</span><span class="hs-identifier hs-var">App</span></span><span> </span><span class="annot"><span class="annottext">(CoreExpr -&gt; CoreExpr -&gt; CoreExpr)
-&gt; CoreM CoreExpr -&gt; CoreM (CoreExpr -&gt; CoreExpr)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; CoreM CoreExpr
</span><a href="Test.Inspection.Plugin.html#dcExpr"><span class="hs-identifier hs-var">dcExpr</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Failure</span><span> </span><span class="annot"><span class="annottext">CoreM (CoreExpr -&gt; CoreExpr) -&gt; CoreM CoreExpr -&gt; CoreM CoreExpr
forall a b. CoreM (a -&gt; b) -&gt; CoreM a -&gt; CoreM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; CoreM CoreExpr
forall (m :: * -&gt; *). MonadThings m =&gt; String -&gt; m CoreExpr
</span><span class="hs-identifier hs-var">mkStringExpr</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185250"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Test.Inspection.Plugin.html#proofPass"><span class="hs-identifier hs-type">proofPass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#UponFailure"><span class="hs-identifier hs-type">UponFailure</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#ReportingMode"><span class="hs-identifier hs-type">ReportingMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CoreM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ModGuts</span></span><span>
</span><span id="line-327"></span><span id="proofPass"><span class="annot"><span class="annottext">proofPass :: UponFailure -&gt; ReportingMode -&gt; CorePluginPass
</span><a href="Test.Inspection.Plugin.html#proofPass"><span class="hs-identifier hs-var hs-var">proofPass</span></a></span></span><span> </span><span id="local-6989586621679185251"><span class="annot"><span class="annottext">UponFailure
</span><a href="#local-6989586621679185251"><span class="hs-identifier hs-var">upon_failure</span></a></span></span><span> </span><span id="local-6989586621679185252"><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679185252"><span class="hs-identifier hs-var">report</span></a></span></span><span> </span><span id="local-6989586621679185253"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185253"><span class="hs-identifier hs-var">guts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UponFailure
</span><a href="#local-6989586621679185251"><span class="hs-identifier hs-var">upon_failure</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><span class="annottext">UponFailure
</span><a href="Test.Inspection.Plugin.html#SkipO0"><span class="hs-identifier hs-var">SkipO0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CorePluginPass
forall a. a -&gt; CoreM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185253"><span class="hs-identifier hs-var">guts</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span class="annot"><span class="annottext">UponFailure
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679185254"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185254"><span class="hs-identifier hs-var">guts'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185255"><span class="annot"><span class="annottext">[(ResultTarget, Obligation)]
</span><a href="#local-6989586621679185255"><span class="hs-identifier hs-var">obligations</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModGuts -&gt; (ModGuts, [(ResultTarget, Obligation)])
</span><a href="Test.Inspection.Plugin.html#extractObligations"><span class="hs-identifier hs-var">extractObligations</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185253"><span class="hs-identifier hs-var">guts</span></a></span><span>
</span><span id="line-332"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679185256"><span class="annot"><span class="annottext">Updates
</span><a href="#local-6989586621679185256"><span class="hs-identifier hs-var">toStore</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679185257"><span class="annot"><span class="annottext">Stats
</span><a href="#local-6989586621679185257"><span class="hs-identifier hs-var">stats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Updates] -&gt; Updates
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([Updates] -&gt; Updates)
-&gt; ([Stats] -&gt; Stats) -&gt; ([Updates], [Stats]) -&gt; (Updates, Stats)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-operator hs-var">`bimap`</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; [Stats] -&gt; Stats
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionsWith</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Updates], [Stats]) -&gt; (Updates, Stats))
-&gt; ([(Updates, Stats)] -&gt; ([Updates], [Stats]))
-&gt; [(Updates, Stats)]
-&gt; (Updates, Stats)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Updates, Stats)] -&gt; ([Updates], [Stats])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">([(Updates, Stats)] -&gt; (Updates, Stats))
-&gt; CoreM [(Updates, Stats)] -&gt; CoreM (Updates, Stats)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-333"></span><span>                </span><span class="annot"><span class="annottext">((ResultTarget, Obligation) -&gt; CoreM (Updates, Stats))
-&gt; [(ResultTarget, Obligation)] -&gt; CoreM [(Updates, Stats)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReportingMode
-&gt; ModGuts -&gt; (ResultTarget, Obligation) -&gt; CoreM (Updates, Stats)
</span><a href="Test.Inspection.Plugin.html#checkObligation"><span class="hs-identifier hs-var">checkObligation</span></a></span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679185252"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185254"><span class="hs-identifier hs-var">guts'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ResultTarget, Obligation)]
</span><a href="#local-6989586621679185255"><span class="hs-identifier hs-var">obligations</span></a></span><span>
</span><span id="line-334"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185266"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679185266"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stats -&gt; Int
forall a. Num a =&gt; Map Stat a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">Stats
</span><a href="#local-6989586621679185257"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span>            </span><span id="local-6989586621679185268"><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185268"><span class="hs-identifier hs-var">guts''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Updates -&gt; CorePluginPass
</span><a href="Test.Inspection.Plugin.html#storeResults"><span class="hs-identifier hs-var">storeResults</span></a></span><span> </span><span class="annot"><span class="annottext">Updates
</span><a href="#local-6989586621679185256"><span class="hs-identifier hs-var">toStore</span></a></span><span>  </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185254"><span class="hs-identifier hs-var">guts'</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679185269"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#Stat"><span class="hs-identifier hs-type">Stat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-339"></span><span>                </span><span id="local-6989586621679185269"><span class="annot"><span class="annottext">q :: Stat -&gt; Int
</span><a href="#local-6989586621679185269"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679185270"><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185270"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Stats -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185270"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Stats
</span><a href="#local-6989586621679185257"><span class="hs-identifier hs-var">stats</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679185284"><span class="annot"><span class="annottext">summary_message :: SDoc
</span><a href="#local-6989586621679185284"><span class="hs-identifier hs-var hs-var">summary_message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><span class="hs-identifier hs-var">nest</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; SDoc) -&gt; SDoc -&gt; SDoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-342"></span><span>                    </span><span class="annot"><span class="annottext">[SDoc] -&gt; SDoc
forall doc. IsDoc doc =&gt; [doc] -&gt; doc
</span><span class="hs-identifier hs-var">vcat</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc -&gt; SDoc
</span><span class="hs-identifier hs-var">nest</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stat -&gt; SDoc
</span><a href="Test.Inspection.Plugin.html#desc"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185286"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">Outputable.&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SDoc
forall doc. IsLine doc =&gt; doc
</span><span class="hs-identifier hs-var">colon</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsLine doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; SDoc
forall a. Outputable a =&gt; a -&gt; SDoc
</span><span class="hs-identifier hs-var">ppr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stat -&gt; Int
</span><a href="#local-6989586621679185269"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185286"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679185286"><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185286"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Stat
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Stat
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Int
</span><a href="#local-6989586621679185269"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="#local-6989586621679185286"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span>            </span><span class="hs-comment">-- Only print a message if there are some compile-time results to report</span><span>
</span><span id="line-346"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; CoreM () -&gt; CoreM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stat -&gt; Int
</span><a href="#local-6989586621679185269"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#StoredResult"><span class="hs-identifier hs-var">StoredResult</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185266"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreM () -&gt; CoreM ()) -&gt; CoreM () -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Int
</span><a href="#local-6989586621679185269"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#ExpSuccess"><span class="hs-identifier hs-var">ExpSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Int
</span><a href="#local-6989586621679185269"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#ExpFailure"><span class="hs-identifier hs-var">ExpFailure</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Stat -&gt; Int
</span><a href="#local-6989586621679185269"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#StoredResult"><span class="hs-identifier hs-var">StoredResult</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679185266"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-348"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CoreM () -&gt; CoreM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReportingMode
</span><a href="#local-6989586621679185252"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="annot"><span class="annottext">ReportingMode -&gt; ReportingMode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReportingMode
</span><a href="Test.Inspection.Plugin.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CoreM () -&gt; CoreM ()) -&gt; CoreM () -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-349"></span><span>                        </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><span class="hs-identifier hs-var">putMsg</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM ()) -&gt; SDoc -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inspection testing successful&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">$$</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185284"><span class="hs-identifier hs-var">summary_message</span></a></span><span>
</span><span id="line-350"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-351"></span><span>                    </span><span class="annot"><span class="annottext">SDoc -&gt; CoreM ()
</span><span class="hs-identifier hs-var">errorMsg</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; CoreM ()) -&gt; SDoc -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inspection testing unsuccessful&quot;</span></span><span> </span><span class="annot"><span class="annottext">SDoc -&gt; SDoc -&gt; SDoc
forall doc. IsDoc doc =&gt; doc -&gt; doc -&gt; doc
</span><span class="hs-operator hs-var">$$</span></span><span> </span><span class="annot"><span class="annottext">SDoc
</span><a href="#local-6989586621679185284"><span class="hs-identifier hs-var">summary_message</span></a></span><span>
</span><span id="line-352"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UponFailure
</span><a href="#local-6989586621679185251"><span class="hs-identifier hs-var">upon_failure</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-353"></span><span>                        </span><span class="annot"><span class="annottext">UponFailure
</span><a href="Test.Inspection.Plugin.html#KeepGoing"><span class="hs-identifier hs-var">KeepGoing</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; CoreM ()
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>                        </span><span class="annot"><span class="annottext">UponFailure
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; CoreM ()
forall a. IO a -&gt; CoreM a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; CoreM ()) -&gt; IO () -&gt; CoreM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span> </span><span class="hs-comment">-- kill the compiler. Is there a nicer way?</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>            </span><span class="annot"><span class="annottext">CorePluginPass
forall a. a -&gt; CoreM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ModGuts
</span><a href="#local-6989586621679185268"><span class="hs-identifier hs-var">guts''</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><a href="Test.Inspection.Plugin.html#desc"><span class="hs-identifier hs-type">desc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Inspection.Plugin.html#Stat"><span class="hs-identifier hs-type">Stat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SDoc</span></span><span>
</span><span id="line-360"></span><span id="desc"><span class="annot"><span class="annottext">desc :: Stat -&gt; SDoc
</span><a href="Test.Inspection.Plugin.html#desc"><span class="hs-identifier hs-var hs-var">desc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#ExpSuccess"><span class="hs-identifier hs-var">ExpSuccess</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  expected successes&quot;</span></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Test.Inspection.Plugin.html#desc"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#UnexpSuccess"><span class="hs-identifier hs-var">UnexpSuccess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unexpected successes&quot;</span></span><span>
</span><span id="line-362"></span><span class="annot"><a href="Test.Inspection.Plugin.html#desc"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#ExpFailure"><span class="hs-identifier hs-var">ExpFailure</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;   expected failures&quot;</span></span><span>
</span><span id="line-363"></span><span class="annot"><a href="Test.Inspection.Plugin.html#desc"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#UnexpFailure"><span class="hs-identifier hs-var">UnexpFailure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; unexpected failures&quot;</span></span><span>
</span><span id="line-364"></span><span class="annot"><a href="Test.Inspection.Plugin.html#desc"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">Stat
</span><a href="Test.Inspection.Plugin.html#StoredResult"><span class="hs-identifier hs-var">StoredResult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;      results stored&quot;</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span id="local-6989586621679184568"><span id="local-6989586621679184569"><span class="annot"><a href="Test.Inspection.Plugin.html#partitionMaybe"><span class="hs-identifier hs-type">partitionMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679184568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679184569"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679184568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679184568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679184569"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-367"></span><span id="partitionMaybe"><span class="annot"><span class="annottext">partitionMaybe :: forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; ([a], [b])
</span><a href="Test.Inspection.Plugin.html#partitionMaybe"><span class="hs-identifier hs-var hs-var">partitionMaybe</span></a></span></span><span> </span><span id="local-6989586621679185292"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679185292"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; ([a], [b])
forall a b. [Either a b] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">partitionEithers</span></span><span> </span><span class="annot"><span class="annottext">([Either a b] -&gt; ([a], [b]))
-&gt; ([a] -&gt; [Either a b]) -&gt; [a] -&gt; ([a], [b])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a b) -&gt; [a] -&gt; [Either a b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679185294"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185294"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; (b -&gt; Either a b) -&gt; Maybe b -&gt; Either a b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185294"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679185292"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679185294"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><span class="hs-comment">-- | like prettySrcLoc, but omits the module name</span></span><span>
</span><span id="line-370"></span><span class="annot"><a href="Test.Inspection.Plugin.html#myPrettySrcLoc"><span class="hs-identifier hs-type">myPrettySrcLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Loc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-371"></span><span id="myPrettySrcLoc"><span class="annot"><span class="annottext">myPrettySrcLoc :: Loc -&gt; String
</span><a href="Test.Inspection.Plugin.html#myPrettySrcLoc"><span class="hs-identifier hs-var hs-var">myPrettySrcLoc</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TH.Loc</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679185296"><span id="local-6989586621679185297"><span id="local-6989586621679185298"><span id="local-6989586621679185299"><span id="local-6989586621679185300"><span class="annot"><span class="annottext">String
CharPos
loc_filename :: String
loc_package :: String
loc_module :: String
loc_start :: CharPos
loc_end :: CharPos
loc_filename :: Loc -&gt; String
loc_package :: Loc -&gt; String
loc_module :: Loc -&gt; String
loc_start :: Loc -&gt; CharPos
loc_end :: Loc -&gt; CharPos
</span><a href="#local-6989586621679185296"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; String) -&gt; String -&gt; [String] -&gt; String
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679185296"><span class="hs-identifier hs-var">loc_filename</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CharPos -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">CharPos
</span><a href="#local-6989586621679185299"><span class="hs-identifier hs-var">loc_start</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CharPos -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">CharPos
</span><a href="#local-6989586621679185299"><span class="hs-identifier hs-var">loc_start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-377"></span></pre></body></html>